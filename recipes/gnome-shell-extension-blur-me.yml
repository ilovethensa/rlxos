id: gnome-shell-extension-blur-me
version: 13
about: |
  Extension that adds a blur look to applications and to different parts of the GNOME Shell, including the top panel, dash and overview 

depends:
  runtime:
    - gnome-shell


sources:
  - blur-me-v{{version}}::https://extensions.gnome.org/extension-data/blur-menunchucks.v{{version}}.shell-extension.zip

packages:
  - id: pkg
    dir: .
    plugin: script
    script: |
      mkdir -p ${pkgupd_pkgdir}/usr/share/gnome-shell/extensions/blur-me@nunchucks 
      unzip blur-me-v{{version}} -d ${pkgupd_pkgdir}/usr/share/gnome-shell/extensions/blur-me@nunchucks
      
      cd ${pkgupd_pkgdir}/usr/share/gnome-shell/extensions/blur-me@nunchucks/

      patch schemas/org.gnome.shell.extensions.blur-me.gschema.xml < ${FILES}/{{id}}/fixed-default-settings.patch
      patch schemas/org.gnome.shell.extensions.blur-me.gschema.xml < ${FILES}/{{id}}/disable-panel-blur.patch
      rm schemas/org.gnome.shell.extensions.blur-my-shell.gschema.xml
      
      glib-compile-schemas schemas

      for i in $(find . -type f) ; do
        chmod 644 ${i}
      done

      for i in $(find . -type d) ; do
        chmod 755 ${i}
      done
