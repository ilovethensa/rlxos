id: lsof
version: 4.95.0
about: Lists open files for running unix processes
depends:
  runtime:
    - glibc
    - libtirpc
sources:
  - https://github.com/lsof-org/lsof/archive/{{version}}/{{id}}-{{version}}.tar.gz

pre-script: |
  sed -i 's|/\* #define\tHASSECURITY\t1 \*/|#define\tHASSECURITY\t1|' dialects/linux/machine.h
  sed -i "s|.so ./version|.ds VN {{version}}|" -i Lsof.8

script: |
  ./Configure -n linux
  make CC="cc ${CFLAGS}"

  install -D -m 0755 lsof -t ${pkgupd_pkgdir}/usr/bin/
  install -D -m 0644 Lsof.8 ${pkgupd_pkgdir}/usr/share/man/man8/lsof.8
  install -D -m 0644 ${FILES_DIR}/LICENSE -t ${pkgupd_pkgdir}/usr/share/doc/lsof/

