id: rlxos-desktop
version: 2200
release: 74
about: GNOME interface for rlxos desktop
build-type: system
type: img
include:
  - core
  - initramfs
  - firmware
  - grub-i386
  - grub
  - plymouth
  - os-prober
  - xorg
  - gnome
  - welcome-tour
  - bolt
  - pam-config
  - poppler-data

# fonts 
  - fonts-cantarell
  - adobe-source-code-pro-fonts
  - ttf-noto
  - ttf-noto-cjk
  - ttf-noto-emoji
  - dejavu-fonts
  - liberation-fonts

# theming
  - fluent-gtk-theme
  - fluent-icon-theme
  - fluent-wallpaper

# extra dependencies
  - fuse2
  - libbsd

# OOBE 
  - cifs-utils
  - ntfs-3g
  - btrfs-progs
  - squashfs-tools
  - flatpak
  - gparted
  - xdg-desktop-portal-gnome

# apps
  - gufw
  - zram-generator
  - android-udev

# virtual environment experience
  - spice-vdagent
  - phodav

inside.root: rlxos
include.path: var/lib/pkgupd/data
inside: |
  make-ca -C /etc/ssl/certdata.txt

  # set fallback/default values
  echo 'LANG=en_IN.UTF-8' > /etc/locale.conf
  ln -sfv /usr/share/zoneinfo/Asia/Kolkata /etc/localtime

  # generating all supported locales
  mkdir -p /usr/lib/locale/
  while read loc format ; do
    localedef -i ${loc} -f ${format} ${loc}.${format}
  done < /var/cache/pkgupd/files/supported_locales

  echo "2200-74" > /etc/rlxos-release

  # TODO should be generated by Installer
  dbus-uuidgen > ${TEMPDIR}/etc/machine-id

  mkdir -p /etc/pkgupd.yml.d/
  echo "system-packages: " > /etc/pkgupd.yml.d/system-packages.yml
  for i in /var/lib/pkgupd/data/* ; do
    if [[ "$i" == "*.files" ]] ; then 
      continue
    fi
    echo " - $(basename $i)">> /etc/pkgupd.yml.d/system-packages.yml
  done

service.system:
  - systemd-oomd
  - systemd-resolved
  - NetworkManager
  - gdm

service.user:
  - pkgupd-watchdog
  - bolt
  - pipewire.socket
  - pipewire-media-session