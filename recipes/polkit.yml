id: polkit
version: 0.119
about: |
  Toolkit for defining and handling authorizations

depends:
  runtime:
    - glib
    - js78
    - pam
    - systemd
    - intltool
    - gobject-introspection
  buildtime:
    - docbook-xsl

groups:
  - id: 27
    name: polkitd

users:
  - id: 27
    name: polkitd
    about: PolicyKit Daemon Owner
    dir: /etc/polkit-1
    group: polkitd
    shell: /bin/false

sources:
  - https://www.freedesktop.org/software/polkit/releases/polkit-{{version}}.tar.gz

build-dir: polkit-{{version}}
build-type: autoconf

configure: >
  --disable-static
  --with-os-type=LFS
  --disable-man-pages

pre-script: |
  sed -i "s:/sys/fs/cgroup/systemd/:/sys:g" configure

post-script: |
  install -v -D -m 644 ${FILES}/pam/polkit-1 ${pkgupd_pkgdir}/etc/pam.d/polkit-1
  install -v -d -m 0750 -o 27 ${pkgupd_pkgdir}/{etc,usr/share}/polkit-1/rules.d

  # set adm as default polkit admin
  sed -i 's|wheel|adm|' ${pkgupd_pkgdir}/etc/polkit-1/rules.d/50-default.rules
      