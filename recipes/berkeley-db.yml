id: berkeley-db
version: 5.3.28
about: |
  Berkeley Database

sources:
  - https://anduin.linuxfromscratch.org/BLFS/bdb/db-5.3.28.tar.gz

packages:
  - id: pkg
    dir: db-5.3.28
    plugin: script
    script: |
      sed -i "s/\(__atomic_compare_exchange\)/\1_db/" src/dbinc/atomic.h
      cd build_unix
      ../dist/configure --prefix=/usr      \
                        --enable-compat185 \
                        --enable-dbm       \
                        --disable-static   \
                        --enable-cxx
      make

      make docdir=/usr/share/doc/berkeley-db/ install DESTDIR=${pkgupd_pkgdir}

      chown -v -R root:root ${pkgupd_pkgdir}