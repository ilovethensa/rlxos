#!/bin/bash
SELF=$(readlink -f "$0")
HERE=${SELF%/*}

PID_FILE='/run/docker.pid'
export PATH=${HERE}/usr/bin:${PATH}

function isRunning() {
    if [ -f ${PID_FILE} ] && [ -d /proc/$(cat ${PID_FILE}) ]  ; then
        return 0
    fi
    return 1
}
if isRunning ; then
    # run cli
    exec ${HERE}/usr/bin/docker ${@}
else
    echo "starting server"
    exec pkexec ${HERE}/usr/bin/dockerd -p ${PID_FILE} -G 'adm' ${@}
fi
