id: file-roller
version: 3.40.0
release: 2
about: |
  An archive manager for GNOME with support for tar, bzip2, gzip, zip, jar, compress, lzop, zstd, and many other archive formats
type: app
bundle: true
depends:
  buildtime:
    - gtk
    - itstool
    - cpio
    - desktop-file-utils
    - json-glib
    - libarchive
    - libnotify
    - appimagetool
  
sources:
  - https://download.gnome.org/sources/file-roller/3.40/file-roller-{{version}}.tar.xz

build-dir: file-roller-{{version}}
configure: --buildtype=release -D packagekit=false
post-script: |
  chmod -v 0755 ${pkgupd_pkgdir}/usr/lib/file-roller/isoinfo.sh
  cp ${FILES_DIR}/file-roller.svg ${pkgupd_pkgdir}/file-roller.png
  cp ${pkgupd_pkgdir}/usr/share/applications/org.gnome.FileRoller.desktop ${pkgupd_pkgdir}/file-roller.desktop

  sed -i 's|Icon=.*|Icon=file-roller|' ${pkgupd_pkgdir}/file-roller.desktop
  sed -i 's|TryExec=.*||' ${pkgupd_pkgdir}/file-roller.desktop
  glib-compile-schemas ${pkgupd_pkgdir}/usr/share/glib-2.0/schemas/

  rm ${pkgupd_pkgdir}/usr/share/help -r
  rm ${pkgupd_pkgdir}/usr/share/metainfo/ -r

  install -v -D -m 0755 ${FILES_DIR}/AppRun -t ${pkgupd_pkgdir}/