id: gnome-music
version: 40.1.1
release: 1
about: Music player and management application
license:
  - GPL
depends:
  buildtime:
    - grilo
    - grilo-plugins
    - gst-plugins-base
    - gtk
    - gvfs
    - libdazzle
    - libdmapsharing
    - libhandy
    - libmediaart
    - py-cairo
    - py-gobject
    - tracker-miners
    - gst-libav
    - gst-plugins-bad
    - gst-plugins-good
    - gobject-introspection
    - appstream-glib
    - itstool
    - appimagetool
type: app
category: multimedia
tags:
  - music
  - player
  - media
sources:
  - https://download.gnome.org/sources/gnome-music/40/gnome-music-{{version}}.tar.xz
post-script: |
  cd ${pkgupd_pkgdir}

  glib-compile-schemas usr/share/glib-2.0/schemas/
  cp usr/share/icons/hicolor/scalable/apps/org.gnome.Music.svg {{id}}.png
  cp usr/share/applications/org.gnome.Music.desktop {{id}}.desktop
  sed -i 's#org.gnome.Music#{{id}}#' {{id}}.desktop
  install -v -m 0755 ${FILES_DIR}/AppRun AppRun
  rm -r usr/share/help

  # include required libraries
  mkdir usr/lib/girepository-1.0/ -p

  # add grilo and plugins
  cp /usr/lib/libgrilo-* usr/lib/
  cp /usr/lib/libgrlnet-* usr/lib/
  cp /usr/lib/libgrlpls-* usr/lib/
  cp /usr/lib/girepository-1.0/Grl*.typelib usr/lib/girepository-1.0/
  cp /usr/bin/grl-inspect-* usr/bin/
  cp /usr/bin/grl-launch-* usr/bin/
  cp /usr/lib/grilo-0.3/ usr/lib/ -a
