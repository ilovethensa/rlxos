id: 0ad
version: 0.0.25b-alpha
about: cross-platform, 3D and historically-based real-time strategy game
depends:
  runtime:
    - binutils
    - libboost
    - curl
    - enet
    - fmt
    - gloox
    - glu
    - icu
    - libglvnd
    - libogg
    - libpng
    - libsodium
    - libvorbis
    - libxml2
    - miniupnpc
    - nspr
    - openal
    - sdl2
    - wxgtk
    - zlib
  buildtime:
    - boost
    - cmake
    - mesa
    - libsm
    - mesa
    - python
    - rustc
    - zip
    - appimagetool
type: app
bundle: true
license: CCPL GPL2

sources:
  - https://releases.wildfiregames.com/{{id}}-{{version}}-unix-build.tar.xz

script: |
  export WX_CONFIG="wx-config-gtk3"
  ./update-workspace.sh -j$(nproc) \
    --without-pch \
    --bindir=/usr/bin \
    --libdir=/usr/lib/0ad \
    --datadir=/usr/share/0ad/data

  VERBOSE=1 make

  install -d ${pkgupd_pkgdir}/usr/{bin,lib/0ad,share/0ad/data}
  install -D -m 0755 binaries/system/pyrogenesis ${pkgupd_pkgdir}/usr/bin/
  install -D -m 0755 binaries/system/*.so ${pkgupd_pkgdir}/usr/lib/0ad/
  cp -r binaries/data/l10n/ ${pkgupd_pkgdir}/usr/share/0ad/data/

  install -Dm0755 build/resources/0ad.sh ${pkgupd_pkgdir}/usr/bin/0ad
  cp build/resources/0ad.desktop ${pkgupd_pkgdir}/
  cp build/resources/0ad.png ${pkgupd_pkgdir}/
