id: pkgupd
version: 2201
release: 7d5c5629c4b1174dfde065db45af33eea30a2916
about: |
  An Extensible package manager for rlxos

depends: 
  runtime: 
    - libyaml-cpp
    - curl
    - zstd
    - libarchive
    - tar
    - bash
    
  buildtime: 
    - cmake

sources:
  - pkgupd-{{version}}-{{release}}.tar.gz::https://github.com/rlxos/pkgupd/archive/{{release}}.tar.gz

prescript: |
  for i in ${FILES}/pkgupd/*.patch ; do
    patch -Np1 -i ${i}
  done

build-dir: pkgupd-{{release}}
post-script: |
  install -v -D -m 0755 _pkgupd_builddir/pkgupd-build ${pkgupd_pkgdir}/usr/bin/pkgupd-builder
  install -v -D -m 0644 _pkgupd_builddir/liblibpkgupd.a ${pkgupd_pkgdir}/usr/lib/libpkgupd.a
  mkdir -p ${pkgupd_pkgdir}/usr/include/libpkgupd/
  cp libpkgupd/*.hh ${pkgupd_pkgdir}/usr/include/libpkgupd/

split:
  - into: pkgupd-builder
    about: PKGUPD builder tool
    files:
      - usr/bin/pkgupd-builder

  - into: libpkgupd
    about: PKGUPD developement library
    files:
      - usr/lib/libpkgupd.a
      - usr/include/libpkgupd/builder.hh
      - usr/include/libpkgupd/colors.hh
      - usr/include/libpkgupd/database.hh
      - usr/include/libpkgupd/defines.hh
      - usr/include/libpkgupd/downloader.hh
      - usr/include/libpkgupd/exec.hh
      - usr/include/libpkgupd/group.hh
      - usr/include/libpkgupd/image.hh
      - usr/include/libpkgupd/installer.hh
      - usr/include/libpkgupd/libpkgupd.hh
      - usr/include/libpkgupd/package.hh
      - usr/include/libpkgupd/packager.hh
      - usr/include/libpkgupd/recipe.hh
      - usr/include/libpkgupd/remover.hh
      - usr/include/libpkgupd/repository.hh
      - usr/include/libpkgupd/resolver.hh
      - usr/include/libpkgupd/stripper.hh
      - usr/include/libpkgupd/system-database.hh
      - usr/include/libpkgupd/tar.hh
      - usr/include/libpkgupd/triggerer.hh
      - usr/include/libpkgupd/user.hh