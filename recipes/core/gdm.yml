id: gdm
version: 40.1
about: |
  A system service that is responsible for providing graphical logins and managing local and remote displays

depends:
  runtime:
    - accountsservice
    - gtk
    - iso-codes
    - itstool
    - libcanberra
    - libdaemon
    - pam
    - systemd
    - dconf

sources:
  - https://download.gnome.org/sources/gdm/40/gdm-40.1.tar.xz

groups:
  - id: 21
    name: gdm
  
users:
  - id: 21
    name: gdm
    group: 21
    about: GDM Daemon Owner
    dir: /var/lib/gdm
    shell: /bin/false

packages:
  - id: pkg
    dir: gdm-40.1
    flags:
      - id: configure
        value: >
          --buildtype=release
          -D gdm-xsession=true
          -D default-pam-config=lfs
 
    postscript: |
      install -v -d -o 21 -g 21 ${pkgupd_pkgdir}/var/lib/gdm
      sed -e "/user = gdm/ s/^#*/#/" -i ${pkgupd_pkgdir}/etc/pam.d/gdm-launch-environment