id: systemd
version: 249
about: |
  Package contains programs for controlling the startup, running, and shutdown of the system

depends:
  runtime:
    - acl
    - bash
    - coreutils
    - diffutils
    - glibc
    - grep
    - py-jinja2
    - libcap
    - sed
    - gawk
    - lz4
    - libseccomp
  buildtime:
    - gcc
    - meson
    - expat
    - gperf
    - libxslt
    - docbook-xsl

sources:
  - https://github.com/systemd/systemd/archive/v{{version}}/systemd-{{version}}.tar.gz

environ:
  - LANG=en_IN.UTF-8
  - PKG_CONFIG_PATH="/usr/lib/pkgconfig"

build-dir: systemd-{{version}}
pre-script: |
  sed -i -e "s/GROUP=\"render\"/GROUP=\"video\"/" -e "s/GROUP=\"sgx\", //" rules.d/50-udev-default.rules.in

build-type: meson
configure: >
  --sysconfdir=/etc
  -D blkid=true
  -D default-dnssec=no
  -D firstboot=false
  -D install-tests=false
  -D sysusers=true
  -D rpmmacrosdir=no
  -D pam=true
  -D userdb=true
  -D pam=true
  -D lz4=true
  -D man=true
  -D mode=release
  -D kmod-path=/usr/bin/kmod
  -D mount-path=/usr/bin/mount
  -D umount-path=/usr/bin/umount
  -D sulogin-path=/usr/bin/sulogin


post-install: |
  systemd-machine-id-setup
  
  journalctl --update-catalog

  systemctl enable \
    getty@tty1.service \
    remote-fs.target