id: subsystem
version: 0.0.5
about: debian base subsystem for rlxos
depends:
  buildtime:
    - debootstrap
    - debian-archive-keyring
    - ca-certificates
    - pcre2
    - libpsl
    - desktop-file-utils
script: |
  MACHINE_PATH=${pkgupd_pkgdir}/{{id}}
  mkdir -p ${MACHINE_PATH}

  debootstrap \
    --arch amd64 \
    --include=systemd-container,sudo \
    stable ${MACHINE_PATH} \
    http://deb.debian.org/debian/

  chroot ${MACHINE_PATH} /usr/sbin/useradd -G sudo -g users -s /bin/bash -m -p $(openssl passwd -1 rlxos) rlxos
  
  install -v -D -m 0755 ${FILES_DIR}/{{id}}.sh ${pkgupd_pkgdir}/usr/bin/{{id}}
  install -v -D -m 0644 ${FILES_DIR}/{{id}}.desktop -t  ${pkgupd_pkgdir}/usr/share/applications/
  install -v -D -m 0644 ${FILES_DIR}/{{id}}.svg -t ${pkgupd_pkgdir}/usr/share/pixmaps/