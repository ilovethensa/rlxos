id: dbus
version: 1.12.20
about: A message bus system, a simple way for applications to talk to one another
sources:
  - https://dbus.freedesktop.org/releases/dbus/dbus-%{version}.tar.gz
build-dir: dbus-%{version}
depends:
  buildtime:
    - python
  runtime:
    - expat
    - systemd

pre-script: |
  rm autogen.sh

configure: >-
  --disable-static 
  --disable-doxygen-docs 
  --disable-xml-docs
  --with-console-auth-dir=/run/console 
  --with-system-pid-file=/run/dbus/pid 
  --with-system-socket=/run/dbus/system_bus_socket
  --libexecdir=/usr/lib/dbus-1.0 
  --localstatedir=/var 
  --enable-systemd 
  --enable-user-session
  --without-x runstatedir=/run

post-script: |
  mkdir -p ${pkgupd_pkgdir}/var/lib/dbus/
  ln -sfv /etc/machine-id ${pkgupd_pkgdir}/var/lib/dbus/
  rm -rf ${pkgupd_pkgdir}/var/run
