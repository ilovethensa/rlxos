merge: [version.yml]
no-strip: true
build-type: system

variables:
  root-password: rlxos

script: |
  if [ -d %{localstatedir}/lib/integrations ] ; then
    for i in %{localstatedir}/lib/integrations/* ; do
      echo "=> integrating $(basename $i)"
      sh -e $i
    done
  fi

  systemd-sysusers
  systemd-tmpfiles --create || true
  systemctl preset-all || true
  systemctl --global preset-all || true

  # TODO: NEEDED?
  pwconv
  grpconv

  echo -e "%{root-password}\n%{root-password}" | passwd
  ln -sv %{datadir}/zoneinfo/Asia/Kolkata %{sysconfdir}/localtime

  echo -n "%{version}" > /usr/.version

build-time:
  - components/grub.yml
  - components/squashfs-tools.yml
  - components/linux.yml
  - components/systemd.yml

include:
  - components/core.yml
  - components/swupd.yml
  - components/layers.yml
  - components/vim.yml

  - components/tzdata.yml
  - components/strace.yml
  - components/grub.yml
  - components/mkinitramfs.yml
  - components/squashfs-tools.yml
  - components/e2fsprogs.yml
  - components/linux.yml

  - components/wlroots.yml
  - components/labwc.yml

  # Fonts
  - components/fonts/cantarell.yml

  # Apps
  - apps/foot.yml
