id: qemu
version: 7.0.0
release: 2
about: |
  A full virtualization solution for Linux on x86 hardware containing virtualization extensions

depends:
  runtime:
   - glib
   - fuse
   - gnutls
   - curl
   - libpng
   - alsa-lib
   - xorg
   - gtk
   - gtk2
   - ncurses
   - sdl2
   - spice
   - cairo
   - samba
   - libusb
   - usbredir
   - libcacard
  buildtime:
   - pkg-config
   - spice-protocol

sources:
  - https://download.qemu-project.org/qemu-{{version}}.tar.xz

build-dir: qemu-{{version}}
build-type: autoconf
configure: >
  --audio-drv-list=alsa
  --smbd=/usr/bin/smbd
  --enable-modules
  --enable-sdl
  --enable-gtk
  --enable-spice
    
post-script: |
  install -v -D -m 644 ${FILES_DIR}/65-kvm.rules -t ${pkgupd_pkgdir}/usr/lib/udev/rules.d/

  chgrp kvm ${pkgupd_pkgdir}/usr/lib/qemu-bridge-helper
  chmod 4750 ${pkgupd_pkgdir}/usr/lib/qemu-bridge-helper
