id: nss
version: 3.68
about: A set of libraries designed to support cross-platform development of security-enabled
  client and server applications
sources:
- https://archive.mozilla.org/pub/security/nss/releases/NSS_3_68_RTM/src/nss-3.68.tar.gz
- https://www.linuxfromscratch.org/patches/downloads/nss/nss-3.68-standalone-1.patch
build-dir: nss-3.68
depends:
  runtime:
  - nspr
  - sqlite
  - p11-kit
pre-script: 'patch -Np1 -i ../nss-3.68-standalone-1.patch

  '
script: "cd nss\nmake BUILD_OPT=1 \\\n  NSPR_INCLUDE_DIR=/usr/include/nspr \\\n  USE_SYSTEM_ZLIB=1\
  \ \\\n  ZLIB_LIBS=-lz \\\n  NSS_ENABLE_WERROR=0 \\\n  USE_64=1 \\\n  NSS_USE_SYSTEM_SQLITE=1\n\
  \ncd ../dist\ninstall -v -D -m 755 Linux*/lib/*.so -t ${pkgupd_pkgdir}/usr/lib/\n\
  install -v -D -m 644 Linux*/lib/{*.chk,libcrmf.a} -t ${pkgupd_pkgdir}/usr/lib/\n\
  install -v -d -m 755 ${pkgupd_pkgdir}/usr/include/nss\ncp -v -RL {public,private}/nss/*\
  \ ${pkgupd_pkgdir}/usr/include/nss\nchmod -v 644 ${pkgupd_pkgdir}/usr/include/nss/*\n\
  \ninstall -v -D -m 755 Linux*/bin/{certutil,nss-config,pk12util} -t ${pkgupd_pkgdir}/usr/bin/\n\
  install -v -D -m 644 Linux*/lib/pkgconfig/nss.pc -t ${pkgupd_pkgdir}/usr/lib/pkgconfig/\n\
  \nln -sfv ./pkcs11/p11-kit-trust.so ${pkgupd_pkgdir}/usr/lib/libnssckbi.so\n"
