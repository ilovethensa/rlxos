id: layers
version: 0.0.1
about: rlxos layers manager

build-type: go-pkg
variables:
  go-pkg: cmd/layers

post-script: |
  mkdir -p %{install-root}/%{libdir}/systemd/system/
  cat >%{install-root}/%{libdir}/systemd/system/layers.service<<EOF
  [Unit]
  Description=Layers Service
  DefaultDependencies=no
  After=local-fs.target
  Before=sysinit.target systemd-tmpfiles-setup.service
  
  [Service]
  Type=oneshot
  RemainAfterExit=yes
  ExecStart=%{bindir/layers refresh
  ExecReload=%{bindir/layers refresh

  [Install]
  WantedBy=sysinit.target
  EOF
