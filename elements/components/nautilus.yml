id: nautilus
version: "40.2"
about: Package contains the GNOME file manager
release: 0
build-time:
- components/bubblewrap.yml
- components/gexiv2.yml
- components/gnome-autoar.yml
- components/gnome-desktop.yml
- components/libhandy.yml
- components/libnotify.yml
- components/libseccomp.yml
- components/tracker-miners.yml
- components/desktop-file-utils.yml
- components/exempi.yml
- components/gst-plugins-base.yml
- components/libexif.yml
- components/libportal.yml
- components/gd.yml
- components/adwaita-icon-theme.yml
- components/gvfs.yml
- components/gobject-introspection.yml
- components/appimagetool.yml
sources:
- https://download.gnome.org/sources/nautilus/40/nautilus-%{version}.tar.xz
pre-script: |
  sed '33d' -i data/meson.build
  sed '46d' -i data/meson.build
  sed '59d' -i data/meson.build
  cat data/meson.build
post-script: |-
  cd %{install-root}

  rm -r usr/lib/{pkgconfig,girepository-1.0}
  rm -r usr/include/

  glib-compile-schemas usr/share/glib-2.0/schemas/
  cp usr/share/icons/hicolor/scalable/apps/org.gnome.Nautilus.svg %{id}.png
  cp usr/share/applications/org.gnome.Nautilus.desktop %{id}.desktop
  sed -i 's#org.gnome.Nautilus#%{id}#' %{id}.desktop

  install -v -m 0755 /files/AppRun AppRun
  sed -i '/^DBusActivatable/d' %{id}.desktop
configure: |
  -D docs=false -D packagekit=false

