id: polkit
version: 0.119
about: Toolkit for defining and handling authorizations

depends:
  - components/glib.yml
  - components/js78.yml
  - components/pam.yml
  - components/systemd.yml
  - components/intltool.yml
  - components/gobject-introspection.yml
build-time:
  - components/docbook-xsl.yml
sources:
  - https://www.freedesktop.org/software/polkit/releases/polkit-%{version}.tar.gz
pre-script: |
  sed -i "s:/sys/fs/cgroup/systemd/:/sys:g" configure
post-script: |
  mkdir -p %{install-root}%{sysconfdir}/pam.d/
  cat > %{install-root}%{sysconfdir}/pam.d/polkit-1 <<EOF
  auth     include        system-auth
  account  include        system-account
  password include        system-password
  session  include        system-session
  EOF
  install -v -d -m 0750 -o 27 %{install-root}/{etc,usr/share}/polkit-1/rules.d
  # set adm as default polkit admin
  sed -i 's|wheel|adm|' %{install-root}%{sysconfdir}/polkit-1/rules.d/50-default.rules

configure: >
  --disable-static
  --with-os-type=LFS
  --disable-man-pages
