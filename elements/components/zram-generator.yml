id: zram-generator
version: 1.1.2
about: System unit generator for zram devices
license: MIT
depends:
  runtime:
    - systemd
  buildtime:
    - rustc

sources:
  - zram-generator-{{version}}.tar.gz::https://github.com/systemd/zram-generator/archive/refs/tags/v{{version}}.tar.gz
build-dir: zram-generator-{{version}}
script: |
  make build CARGOFLAGS="--target-dir=target" NOMAN=1
  make CARGOFLAGS="--target-dir=target" DESTDIR="${pkgupd_pkgdir}" install NOMAN=1
  mkdir -p ${pkgupd_pkgdir}/etc/systemd/
files:
  - path: etc/systemd/zram-generator.conf
    content: |
      [zram0]
      host-memory-limit = none
      zram-fraction = 0.5
      max-zram-size = none
      compression-algorithhm = lzo-rle