id: efivar
version: 38
about: |
  Package provides tools and libraries to manipulate EFI variables

depends:
  buildtime:
    - mandoc
sources:
  - https://github.com/rhboot/efivar/releases/download/{{version}}/efivar-{{version}}.tar.bz2
  - efivar-{{version}}.patch::https://github.com/rhboot/efivar/pull/201/commits/197a0874ea4010061b98b4b55eff65b33b1cd741.patch

build-dir: efivar-{{version}}
script: |

  # fix issues with linker scripts: https://github.com/rhboot/efivar/pull/201
  patch -Np1 -i ../efivar-{{version}}.patch
  
  # disable -Werror
  make ERRORS='' all

  make install DESTDIR=${pkgupd_pkgdir} \
    libdir=/usr/lib \
    bindir=/usr/bin \
    mandir=/usr/share/man \
    includedir=/usr/include -j1 V=1

  install -v -D -m 0644 README.md TODO -t ${pkgupd_pkgdir}/usr/share/doc/efivar