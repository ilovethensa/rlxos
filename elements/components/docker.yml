id: docker
version: 20.10.7
about: Pack, ship and run any application as a lightweight container
release: 0
depends:
- components/containerd.yml
- components/runc.yml
- components/lvm2.yml
- components/btrfs-progs.yml
- components/cgroupfs-mount.yml
build-time:
- components/go.yml
sources:
- https://github.com/moby/moby/archive/v20.10.7/moby-20.10.7.tar.gz
- https://github.com/docker/cli/archive/v20.10.7/cli-20.10.7.tar.gz
- libnetwork-0.3.tar.gz::https://github.com/moby/libnetwork/archive/refs/heads/master.tar.gz
script: "export GOPATH=${pkgupd_srcdir}\nmkdir -p src/github.com/docker\ncd src/github.com/docker\nln
  -s ${pkgupd_srcdir}/cli-20.10.7 cli\ncd cli\nmake VERSION=20.10.7 dynbinary\n\ncd
  ../\nln -s ${pkgupd_srcdir}/moby-20.10.7 docker\ncd docker\nVERSION=20.10.7 hack/make.sh
  dynbinary\nls -al bundles/dynbinary-daemon/\ncd ../\nln -s ${pkgupd_srcdir}/libnetwork-master
  libnetwork\n#ls -al libnetwork/\t\ncd libnetwork/cmd/proxy\nGOROOT=/usr/lib/go go
  build -o %{install-root}/usr/bin/docker-proxy\n\ncd ${pkgupd_srcdir}\n\ninstall
  -D -m 0755 cli-20.10.7/build/docker %{install-root}/usr/bin/docker\ninstall -D -m
  0755 moby-20.10.7/bundles/dynbinary-daemon/dockerd-20.10.7 \\\n  %{install-root}/usr/bin/dockerd\n
  \ \n  #  for M in 1 5 8 ; do\n  #install -d -m 0755 %{install-root}%{datadir}/man/man${M}\n
  \ #install -m 0644 ${pkgupd_srcdir}/man${M}/* %{install-root}%{datadir}/man/man${M}\n
  \ #done\n\nln -s containerd %{install-root}/usr/bin/docker-containerd\nln -s containerd-shim
  %{install-root}/usr/bin/docker-containerd-shim\nln -s ctr %{install-root}/usr/bin/docker-containerd-ctr\nln
  -s runc %{install-root}/usr/bin/docker-runc\n\ninstall -D -m 0755 moby-20.10.7/contrib/check-config.sh
  \\\n  %{install-root}%{datadir}/docker/check-config.sh\n\ninstall -D -m 0755 moby-20.10.7/contrib/init/systemd/docker.{service,socket}
  \\\n  -t %{install-root}/usr/lib/systemd/system/\n\ninstall -D -m 0644 moby-20.10.7/contrib/udev/80-docker.rules
  \\\n  %{install-root}/usr/lib/udev/rules.d/80-docker.rules\n"

