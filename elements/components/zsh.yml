id: zsh
version: 5.9
release: 1
about: A very advance and programmable command interpreter (shell) for UNIX
license:
  - custom
depends:
  runtime:
    - gdbm
    - libcap
    - pcre
  buildtime:
    - yodl

sources:
  - https://www.zsh.org/pub/zsh-{{version}}.tar.xz

pre-script: |
  sed -i 's#/usr/share/keymaps#/usr/share/kbd/keymaps#g' Completion/Unix/Command/_loadkeys
  sed -i 's#/usr/share/misc/usb.ids#/usr/share/usb.ids#g' Completion/Linux/Command/_lsusb

  for _fpath in AIX BSD Cygwin Darwin Debian Mandriva openSUSE Redhat Solaris; do
    rm -rf Completion/$_fpath
    sed "s#\s*Completion/$_fpath/\*/\*##g" -i Src/Zle/complete.mdd
  done
  rm Completion/Linux/Command/_pkgtool

autoconf-dir: true

configure: >
  --docdir=/usr/share/doc/zsh
  --htmldir=/usr/share/doc/zsh/html
  --enable-etcdir=/etc/zsh
  --enable-zshenv=/etc/zsh/shenv
  --enable-zlogin=/etc/zsh/login
  --enable-zlogout=/etc/zsh/logout
  --enable-zprofile=/etc/zsh/profile
  --enable-zshrc=/etc/zsh/zshrc
  --enable-maildir-support
  --with-term-lib='ncursesw'
  --enable-multibyte
  --enable-function-subdirs
  --enable-fndir=/usr/share/zsh/functions
  --enable-scriptdir=/usr/share/zsh/scripts
  --with-tcsetpgrp
  --enable-pcre
  --enable-cap
  --enable-zsh-secure-free

post-script: |
  install -v -D -m 0644 ${FILES}/zsh/profile -t ${pkgupd_pkgdir}/etc/zsh
