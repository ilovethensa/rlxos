name: Bootstrap
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: self-hosted
    timeout-minutes: 46000
    container:
      image: itsmanjeet/devel-docker:2200-3
      env:
        PKGUPD_NO_PROGRESS: 1
      volumes:
        - /storage:/srv/storage.rlxos.dev/packages
        - /sources:/srv/storage.rlxos.dev/sources

    steps:
      - uses: actions/checkout@v2

      - name: Update PKGUPD
        run: ./scripts/update-pkgupd.sh

      - name: Bootstrap
        run: PKGUPD_CONFIG_PATH=$PWD/pkgupd.yml pkgupd build bootstrap build.env=false build.install=true build.skip=filesystem,